!function(n){n.widget("ui.chatbox",{options:{id:null,title:null,user:null,hidden:!1,offset:0,width:300,status:"online",alertmsg:null,alertshow:null,messageSent:function(n,t,i){this.boxManager.addMsg(t.first_name,i)},boxClosed:function(){},boxManager:{init:function(n){this.elem=n},addMsg:function(t,i){var u=this,s=u.elem.uiChatboxLog,r=document.createElement("div"),f,e,o;s.append(r);n(r).hide();f=!1;t?(e=document.createElement("b"),n(e).text(t+": "),r.appendChild(e)):f=!0;o=document.createElement(f?"i":"span");n(o).text(i);r.appendChild(o);n(r).addClass("ui-chatbox-msg");n(r).css("maxWidth",n(s).width());n(r).fadeIn();n(r).find("span").emoticonize();u._scrollToBottom();u.elem.uiChatboxTitlebar.hasClass("ui-state-focus")||u.highlightLock||(u.highlightLock=!0,u.highlightBox())},highlightBox:function(){var n=this;n.elem.uiChatboxTitlebar.effect("highlight",{},300);n.elem.uiChatbox.effect("bounce",{times:2},300,function(){n.highlightLock=!1;n._scrollToBottom()})},toggleBox:function(){this.elem.uiChatbox.toggle()},_scrollToBottom:function(){var n=this.elem.uiChatboxLog;n.scrollTop(n.get(0).scrollHeight)}}},toggleContent:function(){this.uiChatboxContent.toggle();this.uiChatboxContent.is(":visible")&&this.uiChatboxInputBox.focus()},widget:function(){return this.uiChatbox},_create:function(){var t=this,s=t.options,h=s.title||"No Title",r=(t.uiChatbox=n("<div><\/div>")).appendTo(document.body).addClass("ui-widget ui-chatbox").attr("outline",0).focusin(function(){t.uiChatboxTitlebar.addClass("ui-state-focus")}).focusout(function(){t.uiChatboxTitlebar.removeClass("ui-state-focus")}),i=(t.uiChatboxTitlebar=n("<div><\/div>")).addClass("ui-widget-header ui-chatbox-titlebar "+t.options.status+" ui-dialog-header").click(function(n){t.toggleContent(n)}).appendTo(r),u=((t.uiChatboxTitle=n("<span><\/span>")).html(h).appendTo(i),(t.uiChatboxTitlebarClose=n('<a href="#" rel="tooltip" data-placement="top" data-original-title="Hide"><\/a>')).addClass("ui-chatbox-icon ").attr("role","button").hover(function(){u.addClass("ui-state-hover")},function(){u.removeClass("ui-state-hover")}).click(function(){return r.hide(),t.options.boxClosed(t.options.id),!1}).appendTo(i)),f=(n("<i><\/i>").addClass("fa fa-times").appendTo(u),(t.uiChatboxTitlebarMinimize=n('<a href="#" rel="tooltip" data-placement="top" data-original-title="Minimize"><\/a>')).addClass("ui-chatbox-icon").attr("role","button").hover(function(){f.addClass("ui-state-hover")},function(){f.removeClass("ui-state-hover")}).click(function(n){return t.toggleContent(n),!1}).appendTo(i)),e=(n("<i><\/i>").addClass("fa fa-minus").appendTo(f),(t.uiChatboxContent=n('<div class="'+t.options.alertshow+'"><span class="alert-msg">'+t.options.alertmsg+"<\/span><\/div>")).addClass("ui-widget-content ui-chatbox-content ").appendTo(r)),c=((t.uiChatboxLog=t.element).addClass("ui-widget-content ui-chatbox-log custom-scroll").appendTo(e),(t.uiChatboxInput=n("<div><\/div>")).addClass("ui-widget-content ui-chatbox-input").click(function(){}).appendTo(e)),o=(t.uiChatboxInputBox=n("<textarea><\/textarea>")).addClass("ui-widget-content ui-chatbox-input-box ").appendTo(c).keydown(function(i){if(i.keyCode&&i.keyCode==n.ui.keyCode.ENTER)return(msg=n.trim(n(this).val()),msg.length>0&&t.options.messageSent(t.options.id,t.options.user,msg),n(this).val(""),!1)}).focusin(function(){o.addClass("ui-chatbox-input-focus");var t=n(this).parent().prev();t.scrollTop(t.get(0).scrollHeight)}).focusout(function(){o.removeClass("ui-chatbox-input-focus")});i.find("*").add(i).disableSelection();e.children().click(function(){t.uiChatboxInputBox.focus()});t._setWidth(t.options.width);t._position(t.options.offset);t.options.boxManager.init(t);t.options.hidden||r.show();n(".ui-chatbox [rel=tooltip]").tooltip()},_setOption:function(t,i){if(null!=i)switch(t){case"hidden":i?this.uiChatbox.hide():this.uiChatbox.show();break;case"offset":this._position(i);break;case"width":this._setWidth(i)}n.Widget.prototype._setOption.apply(this,arguments)},_setWidth:function(n){this.uiChatbox.width(n+28+"px");this.uiChatboxInputBox.css("width",n+18+"px")},_position:function(n){this.uiChatbox.css("right",n)}})}(jQuery),function(n){n.fn.emoticonize=function(t){for(var o,s,l,e=n.extend({},n.fn.emoticonize.defaults,t),u=[":-)",":o)",":c)",":^)",":-D",":-(",":-9",";-)",":-P",":-p",":-\u00de",":-b",":-O",":-/",":-X",":-#",":'(","B-)","8-)",";*(",":-*",":-\\","?-)",": )",": ]","= ]","= )","8 )",": }",": D","8 D","X D","x D","= D",": (",": [",": {","= (","; )","; ]","; D",": P",": p","= P","= p",": b",": \u00de",": O","8 O",": /","= /",": S",": #",": X","B )",": |",": \\","= \\",": *",": &gt;",": &lt;"],f=[":)",":]","=]","=)","8)",":}",":D",":(",":[",":{","=(",";)",";]",";D",":P",":p","=P","=p",":b",":\u00de",":O",":/","=/",":S",":#",":X","B)",":|",":\\","=\\",":*",":&gt;",":&lt;"],r={"&gt;:)":{cssClass:"red-emoticon small-emoticon spaced-emoticon"},"&gt;;)":{cssClass:"red-emoticon small-emoticon spaced-emoticon"},"&gt;:(":{cssClass:"red-emoticon small-emoticon spaced-emoticon"},"&gt;: )":{cssClass:"red-emoticon small-emoticon"},"&gt;; )":{cssClass:"red-emoticon small-emoticon"},"&gt;: (":{cssClass:"red-emoticon small-emoticon"},";(":{cssClass:"red-emoticon spaced-emoticon"},"&lt;3":{cssClass:"pink-emoticon counter-rotated"},O_O:{cssClass:"no-rotate"},o_o:{cssClass:"no-rotate"},"0_o":{cssClass:"no-rotate"},O_o:{cssClass:"no-rotate"},T_T:{cssClass:"no-rotate"},"^_^":{cssClass:"no-rotate"},"O:)":{cssClass:"small-emoticon spaced-emoticon"},"O: )":{cssClass:"small-emoticon"},"8D":{cssClass:"small-emoticon spaced-emoticon"},XD:{cssClass:"small-emoticon spaced-emoticon"},xD:{cssClass:"small-emoticon spaced-emoticon"},"=D":{cssClass:"small-emoticon spaced-emoticon"},"8O":{cssClass:"small-emoticon spaced-emoticon"},"[+=..]":{cssClass:"no-rotate nintendo-controller"}},h=new RegExp("(\\)|\\(|\\*|\\[|\\]|\\{|\\}|\\||\\^|\\<|\\>|\\\\|\\?|\\+|\\=|\\.)","g"),c="(^|[\\s\\0])",i=u.length-1;i>=0;--i)u[i]=u[i].replace(h,"\\$1"),u[i]=new RegExp(c+"("+u[i]+")","g");for(i=f.length-1;i>=0;--i)f[i]=f[i].replace(h,"\\$1"),f[i]=new RegExp(c+"("+f[i]+")","g");for(o in r)r[o].regexp=o.replace(h,"\\$1"),r[o].regexp=new RegExp(c+"("+r[o].regexp+")","g");return s="span.css-emoticon",e.exclude&&(s+=","+e.exclude),l=s.split(","),this.not(s).each(function(){var t=n(this),i="css-emoticon",o;e.animate&&(i+=" un-transformed-emoticon animated-emoticon");for(o in r)specialCssClass=i+" "+r[o].cssClass,t.html(t.html().replace(r[o].regexp,"$1<span class='"+specialCssClass+"'>$2<\/span>"));n(u).each(function(){t.html(t.html().replace(this,"$1<span class='"+i+"'>$2<\/span>"))});n(f).each(function(){t.html(t.html().replace(this,"$1<span class='"+i+" spaced-emoticon'>$2<\/span>"))});n.each(l,function(i,r){t.find(n.trim(r)+" span.css-emoticon").each(function(){n(this).replaceWith(n(this).text())})});e.animate&&setTimeout(function(){n(".un-transformed-emoticon").removeClass("un-transformed-emoticon")},e.delay)})};n.fn.unemoticonize=function(t){var i=n.extend({},n.fn.emoticonize.defaults,t);return this.each(function(){var t=n(this);t.find("span.css-emoticon").each(function(){var t=n(this);i.animate?(t.addClass("un-transformed-emoticon"),setTimeout(function(){t.replaceWith(t.text())},i.delay)):t.replaceWith(t.text())})})};n.fn.emoticonize.defaults={animate:!0,delay:500,exclude:"pre,code,.no-emoticons"}}(jQuery);var chatboxManager=function(){var i=function(n){$.extend(chatbox_config,n)},r=function(){},n=function(){return(chatbox_config.width+chatbox_config.gap)*showList.length},u=function(n){var i=showList.indexOf(n),t;if(-1!=i)for(showList.splice(i,1),diff=chatbox_config.width+chatbox_config.gap,t=i;t<showList.length;t++)offset=$("#"+showList[t]).chatbox("option","offset"),$("#"+showList[t]).chatbox("option","offset",offset-diff);else alert("NOTE: Id missing from array: "+n)},f=function(i,r){var o=showList.indexOf(i),s=boxList.indexOf(i),e,f;-1!=o||(-1!=s?($("#"+i).chatbox("option","offset",n()),e=$("#"+i).chatbox("option","boxManager"),e.toggleBox(),showList.push(i)):(f=document.createElement("div"),f.setAttribute("id",i),$(f).chatbox({id:i,user:r,title:'<i title="'+r.status+'"><\/i>'+r.first_name+" "+r.last_name,hidden:!1,offset:n(),width:chatbox_config.width,status:r.status,alertmsg:r.alertmsg,alertshow:r.alertshow,messageSent:t,boxClosed:u}),boxList.push(i),showList.push(i),nameList.push(r.first_name)))},t=function(n,t,i){$("#chatlog").doesExist()&&$("#chatlog").append("You said to <b>"+t.first_name+" "+t.last_name+":<\/b> "+i+"<br/>").effect("highlight",{},500);$("#"+n).chatbox("option","boxManager").addMsg("Me",i)};return{init:i,addBox:f,delBox:r,dispatch:t}}();$("a[data-chat-id]:not(.offline)").click(function(n){var t=$(this),i=t.attr("data-chat-id"),r=t.attr("data-chat-fname"),u=t.attr("data-chat-lname"),f=t.attr("data-chat-status")||"online",e=t.attr("data-chat-alertmsg"),o=t.attr("data-chat-alertshow")||!1;chatboxManager.addBox(i,{title:"username"+i,first_name:r,last_name:u,status:f,alertmsg:e,alertshow:o});n.preventDefault()});